//
//  GSSARequestDebitCardViewController.swift
//  GSSAMyMoney
//
//  Created Desarrollo on 28/07/21.
//  Copyright © 2021 ___ORGANIZATIONNAME___. All rights reserved.
//
//  Template generated by Juanpe Catalán @JuanpeCMiOS
//

import UIKit
import GSSAVisualComponents
import GSSAVisualTemplates
import GSSASessionInfo
import GSSAInterceptor

class GSSARequestDebitCardViewController: UIViewController, GSSARequestDebitCardViewProtocol, GSINNavigateDelegate {
	var presenter: GSSARequestDebitCardPresenterProtocol?
    
    @IBOutlet weak var headerView   : UIView!
    @IBOutlet weak var containerView: UIView!
    @IBOutlet weak var gradientView : Gradient!
    @IBOutlet weak var lblAddress   : UILabel!
    
	override func viewDidLoad() {
        super.viewDidLoad()
        headerView.backgroundColor = UIColor.GSVCBase300()
        containerView.layer.cornerRadius = 10.0
        gradientView.layer.cornerRadius = 10.0
        setAddress()
    }
    
    func setAddress(){
        let address = GSSISessionInfo.sharedInstance.gsUser.address
        lblAddress.text = "\((address?.street ?? "").capitalized) \((address?.externalNumber ?? "").capitalized) \((address?.neighborhood ?? "").capitalized) \((address?.city ?? "").capitalized) \(address?.zipCode ?? "")"
    }
    
    @IBAction func next(_ sender: Any){
        let parameters:[String:Any] =
                                    [
                                        "paymentConfig":
                                            [
                                            "productQuantity":"1",
                                            "commission":"0",
                                            "concept":"Donación",
                                            "idCompany":"",
                                            "idReferencePay":"",
                                            "iva":"0",
                                            "amount":"90",
                                            "requieredBill" : true,
                                            "shippingAmount": "90",
                                            "x-idOperacionConciliacion": ""
                                            ],
                                            "viewConfig" :
                                            [
                                            "txtTitle":"Envío de tarjeta física",
                                            "txtSubtitle":"90",
                                            "txtHelper":"Desde qué cuenta compras",
                                            "txtSlideButton": "Desliza para pagar",
                                            ]
                                    ]
                    
                                GSINAdminNavigator.shared.startFlow(forAction: "GSIFTr_PaymentBTN", navigateDelegate: self, withInfo: parameters)
    }
    
    func didFailToEnterFlow(error: NSError) {
        print("Error...")
    }
    
    func willFinishFlow(withInfo info: [String : Any]?) {
        print("MANDAR A RESUMEN...")
    }
    
    @IBAction func editAddress(_ sender: Any){
        let view = GSSAPhysicalCardRequestAddressRouter.createModule()
        self.navigationController?.pushViewController(view, animated: true)
    }
    
    @IBAction func close(_ sender: Any){
        self.navigationController?.popViewController(animated: true)
    }

}
