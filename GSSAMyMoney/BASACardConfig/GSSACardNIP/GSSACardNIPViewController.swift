//
//  GSSACardNIPViewController.swift
//  GSSAMyMoney
//
//  Created Desarrollo on 30/07/21.
//  Copyright © 2021 ___ORGANIZATIONNAME___. All rights reserved.
//
//  Template generated by Juanpe Catalán @JuanpeCMiOS
//

import UIKit
import GSSAVisualComponents
import GSSASessionInfo

class GSSACardNIPViewController: UIViewController, GSSACardNIPViewProtocol, GSVCBottomAlertHandler {
    
    var bottomAlert: GSVCBottomAlert?
    var presenter: GSSACardNIPPresenterProtocol?
    
    @IBOutlet weak var txtNIP1: UITextField!
    @IBOutlet weak var txtNIP2: UITextField!
    @IBOutlet weak var txtNIP3: UITextField!
    @IBOutlet weak var txtNIP4: UITextField!
    
    var NIP = ""
    
    override func viewDidLoad() {
        super.viewDidLoad()
        self.navigationController?.setNavigationBarHidden(true, animated: false)
        requestNIP()
        setNIP()
    }
    
    func optionalAction() {}
    
    func requestNIP(){
        let body = RequestNIPBody.init(transaccion: RequestNIPTransaccion.init(primerTokenVerificacion: GSSISessionInfo.sharedInstance.gsUser.account?.number, tarjeta: RequestNIPCard.init(numero: "", numeroContrato: "", codigoSeguridad: "", idCliente: ""), clienteUnico: ClienteUnico.init(idPais: "001", idCanal: "033", idSucursal: "7760", folio: "88582")))
        presenter?.requestCardNIP(body: body, Response: {
            print("OK")
        })
    }
    
    func setNIP(){
        if NIP.count == 4{
            let characters = Array(NIP)
            txtNIP1.text = characters[0].toString()
            txtNIP2.text = characters[1].toString()
            txtNIP3.text = characters[2].toString()
            txtNIP4.text = characters[3].toString()
        }
    }
    
    @IBAction func close(_ sender: Any){
        let viewControllers: [UIViewController] = self.navigationController!.viewControllers as [UIViewController]
        for VC in viewControllers{
            if VC is BASACardConfigViewController{
                self.navigationController?.popToViewController(VC, animated: true)
            }
        }
    }
}
